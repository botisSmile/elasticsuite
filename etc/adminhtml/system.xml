<!--
/**
 * Elasticsuite Recommender module configuration
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Smile Searchandising Suite to newer
 * versions in the future.
 *
 * @category  Smile
 * @package   Smile\ElasticsuiteRecommender
 * @author    Richard BAYET <richard.bayet@smile.fr>
 * @copyright 2019 Smile
 * @license   Open Software License ("OSL") v. 3.0
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd">
    <system>
        <section id="smile_elasticsuite_recommender" translate="label" type="text" sortOrder="1000" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Recommender</label>
            <tab>smile_elasticsuite</tab>
            <resource>Magento_Backend::smile_elasticsuite_recommender</resource>

            <group id="general" translate="label" type="text" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
                <label>General</label>
                <field id="exclude_already_bought" type="select" translate="label comment" sortOrder="5" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Exclude from recommendations any product already bought by the visitor</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment><![CDATA[Applies only to automated recommendations and not to manually selected products.]]></comment>
                </field>
                <field id="exclude_already_bought_max_age" translate="label comment" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Product bought exclusion window size as a number of days</label>
                    <validate>integer</validate>
                    <comment><![CDATA[For instance "90" will mean no product bought by the visitor in the past 90 days will be recommended. 0 means no time restriction at all : no product ever bought by the visitor will be recommended to him. Be careful that this setting impact is heavily dependent on the tracker "Retention delay" and "Visitor Cookie Lifetime" parameters.]]></comment>
                    <depends>
                        <field id="exclude_already_bought" separator=",">1</field>
                    </depends>
                </field>
                <field id="prevent_zero_constraints_queries" translate="label comment" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Prevent defaulting to whole catalog</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment><![CDATA[In some conditions, there might not be any event yet (searches, views, sales, ...) for a product (e.g. for a new product) and so not constraint on the recommendation request for that product. If set to Yes, this will prevent such a recommendation request to be executed and no products will be shown. If set to No, the request would end up displaying generic products picked from the whole catalog.]]></comment>
                </field>
                <field id="related_position_limit" translate="label" sortOrder="15" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Maximum Number of Products in Related Products List</label>
                    <validate>integer validate-greater-than-zero validate-number-range number-range-1-20</validate>
                </field>
                <field id="related_behavior" type="select" translate="label" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Show Related Products</label>
                    <source_model>Smile\ElasticsuiteRecommender\Model\Product\Matcher\Source\Behavior</source_model>
                </field>
                <field id="related_exclude_composite_products" type="select" translate="label" sortOrder="25" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Exclude composite (bundle, grouped, configurable) from Related Products List</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <depends>
                        <field id="related_behavior" separator=",">0,2</field>
                    </depends>
                </field>
                <field id="crosssell_position_limit" translate="label" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Maximum Number of Products in Cross-Sell Products List</label>
                    <validate>integer validate-greater-than-zero validate-number-range number-range-1-20</validate>
                </field>
                <field id="crosssell_behavior" type="select" translate="label" sortOrder="35" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Show Cross-Sell Products</label>
                    <source_model>Smile\ElasticsuiteRecommender\Model\Product\Matcher\Source\Behavior</source_model>
                </field>
                <field id="upsell_position_limit" translate="label" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Maximum Number of Products in Upsell Products List</label>
                    <validate>integer validate-greater-than-zero validate-number-range number-range-1-20</validate>
                </field>
                <field id="upsell_behavior" type="select" translate="label" sortOrder="45" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Show Upsell Products</label>
                    <source_model>Smile\ElasticsuiteRecommender\Model\Product\Matcher\Source\Behavior</source_model>
                </field>
                <field id="upsell_native_selection_complement" type="select" translate="label comment" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Allow native complement of manually selected upsell products</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment><![CDATA[If set to Yes, will dispatch the native event which ensures that any bundle product the current product appears in is added to the manual upsell products selection. This will of course potentially restrict the size of the automated recommendations.]]></comment>
                    <depends>
                        <field id="upsell_behavior" separator=",">0,1</field>
                    </depends>
                </field>
                <field id="upsell_force_higher_price" type="select" translate="label comment" sortOrder="55" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Force Higher Price for Upsell Products</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment><![CDATA[If set to Yes, will ensure that products automatically recommended based on past tracked events have a higher price than the base product. This has no impact on the manually configured upsell products.]]></comment>
                    <depends>
                        <field id="upsell_behavior" separator=",">0,2</field>
                    </depends>
                </field>
            </group>

            <group id="cooccurrence" translate="label" type="text" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
                <label>Events co-occurrence configuration</label>
                <field id="min_doc_count" translate="label comment" type="text" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Min doc count</label>
                    <validate>integer</validate>
                    <comment><![CDATA[When gathering co-occurrence of products related events (products also viewed, added to cart, bought), in how many distinct sessions an event must occur at the minimum to be taken into account. Lowering it can be helpful on sites without much events tracking history to avoid a cold start.]]></comment>
                </field>
                <field id="similarity_attributes" translate="label comment" type="multiselect" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Similarity attributes</label>
                    <comment><![CDATA[Attributes that will be used to find products similar to the co-occurrent products. The list is made of attributes that are searchable, can provide text values to the search engine and are configured to either be sortable or filterable in layer navigation.]]></comment>
                    <source_model>Smile\ElasticsuiteRecommender\Model\Config\Source\SimilarityAttributes</source_model>
                    <validate>required-entry</validate>
                </field>
            </group>
        </section>
    </system>
</config>
